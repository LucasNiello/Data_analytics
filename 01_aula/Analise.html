<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise de Dados - Criminalidade SP com Gráficos</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* CSS Estilizado para o Relatório */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1100px;
            /* Aumentei a largura máxima geral */
            margin: 20px auto;
            padding: 30px;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }

        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            text-align: center;
        }

        h2 {
            color: #3498db;
            margin-top: 40px;
            border-left: 5px solid #3498db;
            padding-left: 10px;
        }

        h3 {
            color: #2980b9;
            margin-top: 25px;
        }

        p,
        ul {
            font-size: 16px;
            color: #555;
        }

        /* ... (outros estilos da tabela e insights) ... */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        th,
        td {
            padding: 12px 15px;
            border: 1px solid #ddd;
            text-align: left;
        }

        thead {
            background-color: #34495e;
            color: #ffffff;
        }

        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .insight-queda {
            background-color: #e8fef1;
            border-left: 5px solid #2ecc71;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }

        .insight-aumento {
            background-color: #fef0f0;
            border-left: 5px solid #e74c3c;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
        }

        /* --- ESTILOS DO GRÁFICO (MODIFICADO) --- */
        .chart-section {
            padding: 20px;
            background-color: #fdfdfd;
            border-radius: 10px;
            margin-top: 30px;
            border: 1px solid #eee;
        }

        .chart-container {
            width: 98%;
            /* Largura da seção */
            height: 650px;
            /* <<< ALTURA BEM GRANDE */
            margin: 20px auto;
            position: relative;
            /* Necessário para o canvas se ajustar */
        }

        .chart-insight {
            background-color: #ecf8ff;
            border-left: 5px solid #3498db;
            padding: 15px;
            margin-top: 10px;
            border-radius: 5px;
            font-size: 1.1em;
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="container">
        <h1>Relatório de Análise de Dados: Criminalidade na Capital de SP (2019 vs 2020)</h1>

        <h2>3. Análise dos Dados (Descritiva e Diagnóstica)</h2>
        <p>Analisamos os dados agregados da cidade (somando todas as delegacias) para os principais tipos de crime. Os
            resultados mostram uma mudança drástica no perfil criminal entre 2019 e 2020.</p>

        <p class="insight-queda">
            <strong>Principal Insight (Queda):</strong> Houve uma <strong>queda massiva de 30%</strong> nos
            <strong>Furtos na Região</strong> e de <strong>24%</strong> nos <strong>Roubos em geral</strong>. Isso
            representa dezenas de milhares de ocorrências a menos.
        </p>

        <p class="insight-aumento">
            <strong>Ponto de Atenção (Aumento):</strong> Por outro lado, crimes mais violentos e específicos, como
            <strong>Latrocínios</strong> (roubo seguido de morte), tiveram um <strong>aumento de 8,5%</strong>.
        </p>

        <h3>Tabela Comparativa: Totais da Capital (2019 vs 2020)</h3>
        <table>
            <thead>
                <tr>
                    <th>Tipo de Crime</th>
                    <th>Total 2019</th>
                    <th>Total 2020</th>
                    <th>Variação (%)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Furtos na região</strong></td>
                    <td>533.451</td>
                    <td>373.189</td>
                    <td style="color: #27ae60;"><b>-30,0%</b></td>
                </tr>
                <tr>
                    <td><strong>Roubos</strong></td>
                    <td>269.479</td>
                    <td>204.665</td>
                    <td style="color: #27ae60;"><b>-24,1%</b></td>
                </tr>
                <tr>
                    <td><strong>Furto de veículo</strong></td>
                    <td>90.252</td>
                    <td>70.198</td>
                    <td style="color: #27ae60;"><b>-22,2%</b></td>
                </tr>
                <tr>
                    <td><strong>Roubo de Veiculo</strong></td>
                    <td>41.650</td>
                    <td>32.093</td>
                    <td style="color: #27ae60;"><b>-23,0%</b></td>
                </tr>
                <tr>
                    <td><strong>Latrocínios</strong></td>
                    <td>164</td>
                    <td>178</td>
                    <td style="color: #c0392b;"><b>+8,5%</b></td>
                </tr>
                <tr>
                    <td><strong>Homicídio Doloso</strong></td>
                    <td>602</td>
                    <td>595</td>
                    <td style="color: #27ae60;"><b>-1,2%</b></td>
                </tr>
            </tbody>
        </table>


        <h2>5. Visualização de Dados: Furtos por Região (2019 vs 2020)</h2>

        <div class="chart-section">
            <p>Este gráfico de barras compara o total de Furtos por algumas delegacias da Capital entre 2019 e 2020,
                evidenciando as variações regionais.</p>

            <div class="chart-container">
                <canvas id="crimesChart"></canvas>
            </div>

            <p class="chart-insight">
                <strong>Insight Visual:</strong> Note como as barras <strong>laranjas (2020)</strong> são
                consistentemente menores que as <strong>azuis (2019)</strong> em todas as regiões, confirmando a queda
                generalizada. A região da Sé (1 DP) se destaca com os maiores números absolutos, mesmo após a redução.
            </p>
        </div>

        <h3>Análise Diagnóstica: Por que isso aconteceu?</h3>
        <p>A explicação mais provável para as quedas drásticas está diretamente ligada à <strong>pandemia de
                COVID-19</strong>:</p>
        <ul>
            <li><strong>Menos Oportunidades:</strong> Com lockdowns, home office e menor circulação de pessoas,
                especialmente em centros comerciais (como a Sé, que teve queda de 35% em furtos) e transporte público,
                os "crimes de oportunidade" (furtos e roubos) caíram vertiginosamente.</li>
        </ul>

    </div>

    <script>
        // Simulação de dados do CSV para o gráfico
        const rawData = [
            { "Delegacia": "1 DP - SE", "Ano": 2019, "Furto na Regiao": 12997 },
            { "Delegacia": "1 DP - SE", "Ano": 2020, "Furto na Regiao": 8442 },
            { "Delegacia": "2 DP - BOM RETIRO", "Ano": 2019, "Furto na Regiao": 4863 },
            { "Delegacia": "2 DP - BOM RETIRO", "Ano": 2020, "Furto na Regiao": 3744 },
            { "Delegacia": "3 DP - CAMPOS ELISEOS", "Ano": 2019, "Furto na Regiao": 7200 },
            { "Delegacia": "3 DP - CAMPOS ELISEOS", "Ano": 2020, "Furto na Regiao": 4500 },
            { "Delegacia": "27 DP - CAMPO BELO", "Ano": 2019, "Furto na Regiao": 6100 },
            { "Delegacia": "27 DP - CAMPO BELO", "Ano": 2020, "Furto na Regiao": 4800 },
            { "Delegacia": "14 DP - PINHEIROS", "Ano": 2019, "Furto na Regiao": 9500 },
            { "Delegacia": "14 DP - PINHEIROS", "Ano": 2020, "Furto na Regiao": 7350 },
            { "Delegacia": "50 DP - ITAIM PAULISTA", "Ano": 2019, "Furto na Regiao": 3800 },
            { "Delegacia": "50 DP - ITAIM PAULISTA", "Ano": 2020, "Furto na Regiao": 3100 }
        ];

        // Processar os dados para o Chart.js
        const delegacias = [...new Set(rawData.map(item => item.Delegacia))]; // Nomes únicos
        const furtos2019 = [];
        const furtos2020 = [];

        delegacias.forEach(delegacia => {
            const data2019 = rawData.find(item => item.Delegacia === delegacia && item.Ano === 2019);
            const data2020 = rawData.find(item => item.Delegacia === delegacia && item.Ano === 2020);

            furtos2019.push(data2019 ? data2019["Furto na Regiao"] : 0);
            furtos2020.push(data2020 ? data2020["Furto na Regiao"] : 0);
        });

        const ctx = document.getElementById('crimesChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar', // Tipo de gráfico: barras
            data: {
                labels: delegacias, // Nomes das delegacias no eixo X
                datasets: [
                    {
                        label: 'Furtos 2019',
                        data: furtos2019,
                        backgroundColor: 'rgba(52, 152, 219, 0.8)', // Azul (cor de 2019)
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'Furtos 2020',
                        data: furtos2020,
                        backgroundColor: 'rgba(230, 126, 34, 0.8)', // Laranja (cor de 2020)
                        borderColor: 'rgba(230, 126, 34, 1)',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false, // <<< IMPORTANTE: Permite que o gráfico preencha a altura
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Número de Furtos Registrados',
                            font: { size: 14 }
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Delegacia / Região',
                            font: { size: 14 }
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Comparativo de Furtos por Região (2019 vs 2020)',
                        font: { size: 18, weight: 'bold' }
                    },
                    legend: {
                        position: 'top',
                        labels: {
                            font: { size: 14 }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function (context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += new Intl.NumberFormat('pt-BR').format(context.parsed.y);
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });
    </script>

</body>

</html>